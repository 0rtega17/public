<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Driver's Registration</title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

    

    <!-- Custom styles for this template-->
    <link href="css/admin.min.css" rel="stylesheet">


    <!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">


</head>

<body class="bg-gradient-primary" style="background: url('img/addBg.png');">

    <center>
    <img src="img/logo.png" style="width:237px; height: 143px;">
    <h1 style=" position:relative; text-align: center; font-weight: 900; font-size: 5vw; color:black; letter-spacing: -3px;"> 
                        Driver Registration</h1>
     </center>                   
    <div class="container" style="position:relative; top:-20px; ">

        <div class="card o-hidden border-0 shadow-lg my-5">
            <div class="card-body p-0">
                <!-- Nested Row within Card Body -->

                <div class="row">
                    <div style="background-color: #272727; padding: 20px; position:relative;"class="col-lg-12" >  

                        
                        <p style="background-color: #272727;  color: white; font-weight: bold; position:relative; text-align: center; font-size:3.5vw; margin-bottom: -5px;"> 
                        E-Hatid Digital ID Card 
                        <a href="ManageDriver.html" > <img class="tryA" src="img/close.png" style="position: relative; top: -5px; left:12vw; margin-right: 30px;"  > </a>  </p>
                    
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-12" style="background-color: #F4ECBF;">
                        <div class="p-5">
                            <div class="text-center">
                                
                            </div>
                            <form class="user">

                                <p style=" color: black; font-weight: bold; position:relative; top: -2vh; left: .5vw; text-align: center;"> 
                                    Tricycle Operators and Drivers Association in Toda G4 Lourdes Terminal </p>
                                 
                            <div class="form-group row">
                                    <div class="input-group mb-6 col-sm-6 mb-3 mb-sm-0">
                                    
                                    <input type="text" class="form-control" id="first_name"
                                     style="border-radius: 30px; height: 50px; font-size: 12px;" placeholder="First Name">
                                    
                                    </div> 
                                    
                                    <div class="input-group mb-6 col-sm-6">
                                    
                                        <input type="text" class="form-control" id="last_name"
                                         style="border-radius: 30px; height: 50px; font-size: 12px;" placeholder="Last Name">
                                        
                                        </div> 
                            </div>            
                                <div class="input-group mb-2">
    
                                        <input type="text" class="form-control" id="email"
                                        style="border-radius: 30px; height: 50px; font-size: 12px;" placeholder="Email Address">
                                           
                                </div>
                                <div class="input-group mb-2">
                                        <input type="text" class="form-control" id="username"
                                        style="border-radius: 30px; height: 50px; font-size: 12px;" placeholder="Username">
                                </div>
                                <div class="input-group mb-2">
                                    
                                    <input type="password" class="form-control" id="password" style="border-radius: 30px; height: 50px;  font-size: 12px;"
                                    type="password" placeholder="Password">
                                    <i class="far fa-eye" id="togglePassword" onclick="passwordSee()"
                                    style="cursor: pointer;  position:relative; left:-15px; z-index: 100;margin-left: -20px; margin-top: 18px;"></i>
                                </div>
                                <div class="input-group mb-2">
                                    <input type="date" class="form-control" id="birthdate"
                                    style="border-radius: 30px; height: 50px; font-size: 12px;">
                                </div>
                                <div class="input-group mb-2">
                                    <input type="text" class="form-control" id="phoneNum" placeholder="Mobile Number"
                                    style="border-radius: 30px; height: 50px; font-size: 12px;">
                                </div>
                                <div class="input-group mb-2">
                                    <input type="text" class="form-control" id="licenseNum" placeholder="License Number"
                                    style="border-radius: 30px; height: 50px; font-size: 12px;">
                                </div>
                                <div class="input-group mb-2">
                                    <input type="text" class="form-control" id="plateNumber" placeholder="Plate Number"
                                    style="border-radius: 30px; height: 50px; font-size: 12px;">
                                </div>
                               
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="d-flex justify-content-around" style="position: relative; top: -30px;">
        <div class="d-flex justify-content-start">
            <button type="button"  id="submitDriver" name="submitDriver" class="addBtn" style="background-color: black; max-width:100%;" > Submit </button>
        </div>
        <div class="d-flex justify-content-end">
            <input class="addBtn" type="reset" value="Clear"style=" background-color: black; left:20vw; max-width:100%;">
        </div>
    </div>
    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/admin.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/i18n/defaults-*.min.js"></script>


    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <!-- Adding Driver's Information -->
    <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js";
import { getDatabase, set, ref ,push, child, onValue, get} from "https://www.gstatic.com/firebasejs/9.10.0/firebase-database.js";
import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-auth.js";

// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyAYLfR72YvVWK7NKuYv0i8cZLeOyky_2UI",
  authDomain: "e-hatid-ac4b8.firebaseapp.com",
  databaseURL: "https://e-hatid-ac4b8-default-rtdb.firebaseio.com",
  projectId: "e-hatid-ac4b8",
  storageBucket: "e-hatid-ac4b8.appspot.com",
  messagingSenderId: "151893715495",
  appId: "1:151893715495:web:c66ce45a224b36f0113c02",
  measurementId: "G-K4WTYXS330"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);

// Get a reference to the database service
const database = getDatabase(app);
const auth = getAuth(app);


// write data <button class="addBtn" type="button" > <a href="addDriver.html" style="color:white; text-decoration: none;"><i class="fa fa-plus-circle" aria-hidden="true"></i>
//Add New Driver </a></button>
submitDriver.addEventListener('click', Validate);

function Validate()
{
    var firstName = document.getElementById('first_name').value;  
    var lastName = document.getElementById('last_name').value;  
    var email = document.getElementById('email').value; 
    var username = document.getElementById('username').value;  
    var plateNumber = document.getElementById('plateNumber').value;  
    var password = document.getElementById('password').value;
    var upperCaseLetters = /[A-Z]/g;
    var birthdate = document.getElementById('birthdate').value; 
    var licenseNum = document.getElementById('licenseNum').value; 
    var phoneNum = document.getElementById('phoneNum').value; 
    
    if(firstName=="")
    {
        swal({
            title: "Enter First Name!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }
    else if(lastName=="")
    {
        swal({
            title: "Enter Last Name!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }
    else if(email=="")
    {
        swal({
            title: "Enter Email!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }
    
    else if(username=="")
    {
        swal({
            title: "Enter Usename!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }   

    
    else if(password=="")
    {
        swal({
            title: "Enter Password!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }     

    else if(password.length < 8)
    {
        swal({
            title: "Invalid Password!",
            text: "It has to be 8 characters long.",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    } 
 
    
    else if($("#birthdate").val()=="")
    {
        swal({
            title: "Enter Birthdate!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }
    else if(phoneNum=="")
    {
        swal({
            title: "Enter Mobile Number!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }
    else if(phoneNum.length !== 11)
    {
        swal({
            title: "Invalid Mobile Number!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }
   
    else if(licenseNum=="")
    {
        swal({
            title: "Enter License Number!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }   
    else if(plateNumber=="")
    {
        swal({
            title: "Enter Plate Number!",
            text: "Please enter the right credentials!",
            icon: "error",
            timer: 2000,
            showConfirmButton: false
            //button: "Try again",
          })
    }   
    
    else
    {
    createUserWithEmailAndPassword(auth, email, password)
     .then((userCredential) => {
     // Signed in 
     const user = userCredential.user;

     set(ref(database, 'drivers/' + user.uid),{
         first_name: firstName,
         last_name: lastName,
         birthdate: birthdate,
         email: email,
         username: username,
         password: password,
         licenseNum: licenseNum,
         phone: phoneNum,
         plateNum: plateNumber,
         earnings: "0.00",
         ratings: "0",
         id: user.uid,
         

     })

     swal({
        title: "Success!",
        text: "The passengers has successfully registered!",
        icon: "success",
        timer: 5000,
        showConfirmButton: false
        //button: "Try again",
      }).then(function() {
      window.location = "ManageDriver.html";
     });
     //window.location.href="ManageDriver.html";
     // ...
     })
     .catch((error) => {
     const errorCode = error.code;
     const errorMessage = error.message;

     swal({
        title: "Error!",
        text: errorMessage,
        icon: "error",
        timer: 3000,
        showConfirmButton: false
        //button: "Try again",
      })
     // ..
     });
    }
 }
    
 
</script>

<script type="text/javascript">
    function passwordSee() {
    var x = document.getElementById("password");
    if (x.type === "password") {
    x.type = "text";
     } else {
    x.type = "password";
    }
    }
 </script>   

</body>

</html>